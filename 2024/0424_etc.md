### Garbage Collection

오늘 팀원분이 팀장님과 대화하면서 “GC가 발생했죠.”라고 하시는 게 딱 귀에 꽂혔으니까 오늘은 너로 정했다, GC!

#### GC가 뭔데?

자바 모니터링에서 중요한 지표는 Heap 메모리 지표와 GC 지표이다.

가비지 컬렉션(Garbage Collection, GC)은 프로그래밍 언어나 런타임 환경이 자동으로 메모리에서 사용하지 않는 객체를 해제하는 메모리 관리 기술을 말한다. 가비지 컬렉션은 메모리 누수를 방지하여 애플리케이션의 안정성과 성능을 향상시킬 수 있다.

일반적으로 가비지 컬렉션은 다음과 같은 과정을 거친다.

1. **객체 생성**: 프로그램이 실행되면서 객체들이 메모리에 생성된다. 이 객체들은 변수에 할당되거나 데이터 구조에 추가될 수 있다.

2. **객체 사용**: 생성된 객체들은 프로그램에서 사용된다. 변수에 할당되거나 다른 객체들과 상호작용하여 작업이 수행된다.

3. **객체 불필요성 판단**: 가비지 컬렉션은 주기적으로 또는 필요할 때 실행되어 메모리에 있는 객체 중에서 더 이상 참조되지 않는 객체들을 식별한다. 이러한 객체들을 가비지라고 하는 것. 🚮

4. **가비지 수집**: 가비지 컬렉션은 식별된 가비지 객체들을 메모리에서 해제하여 사용 가능한 공간을 회수한다. 이러한 프로세스는 메모리를 최적화하고 사용 가능한 메모리를 늘리는 데 도움이 된다.

가비지 컬렉션의 장점은 메모리 관리를 자동화하여 개발자가 메모리 관리에 대한 부담을 줄여준다는 것이다. 장점만 생각했을 땐 무조건 필요하고, 무조건 좋을 것 같은데 ... 가비지 컬렉션은 실행 속도를 느리게 할 수 있고, 예측 불가능한 시간에 가비지 수집이 발생할 수 있어 실시간 시스템에서는 부적합할 수 있다고 한다. 즉, 이 녀석도 각 상황에 맞게 적절한 메모리 관리 전략을 선택하는 것이 중요하다.

#### Whatap 에서 GC 모니터링하기

Heap 메모리나 GC에 대한 지표는 애플리케이션 모니터링에서 `분석 > 매트릭스 차트 > 애플리케이션 카테고리` 선택 후 지표 차트를 추가해서 시간대별로 확인할 수 있다.
주로 Heap 최대사용량, Heap 크기, Heap 사용량으로 현재 Heap 메모리를 확인하면 된다. Old Generation GC건수, GC 시간이 늘어나고 CPU 사용량이 높아지면 비정상 케이스라고 판단한다. (무조건 비정상인 건 아니고 나름의 기준으로 판단하기)
