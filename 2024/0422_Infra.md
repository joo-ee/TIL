### 블루-그린 배포와 롤링 배포

얼마 전에 회사 배포 방식이 변경됐다. 블루-그린 배포에서 롤링 배포가 추가되어 개발자 판단에 따라 두 전략 중 하나를 골라서 배포할 수 있는데, 뭘 … 알아야지 선택을 하지? 🙄

#### 개념 정리부터 !

블루그린 배포와 롤링 배포는 애플리케이션을 업데이트하고 배포하는 두 가지 주요 전략이다.

- **블루그린 배포 (Blue-Green Deployment)**

  - 새로운 버전의 애플리케이션을 기존 버전의 애플리케이션과 병행하여 배포하는 전략
  - 블루 애플리케이션과 그린 애플리케이션 두 개의 환경이 별도로 구성(현재 운영 중인 버전 = 블루, 새로운 버전 = 그린)
  - 새로운 버전의 애플리케이션이 배포되면 트래픽을 블루에서 그린으로 전환하여 새로운 버전을 사용자에게 노출
  - 이후 문제가 발생하면 블루로 트래픽을 다시 전환하여 롤백
  - 블루그린 배포는 전환 시간이 짧고 롤백이 쉬우며, 사용자에게 거의 무한한 가용성을 제공할 수 있음

- **롤링 배포 (Rolling Deployment)**
  - 새로운 버전의 애플리케이션을 점진적으로 배포하는 전략
  - 기존의 애플리케이션 인스턴스를 하나씩 새로운 버전으로 교체하면서 배포를 진행 (서비스 무중단)
  - 롤링 배포는 서비스의 가용성을 유지하면서 안정적으로 애플리케이션을 업데이트할 수 있음
  - 그러나 롤링 배포 중에는 사용자들이 다른 버전의 애플리케이션을 사용하게 될 수 있으며, 일부 사용자에게는 버전이 변경되는 과정에서 장애가 발생할 수 있음

블루그린 배포와 롤링 배포는 각각의 장단점이 있으며, 애플리케이션의 요구 사항과 특성에 따라 적절한 전략을 선택해야 할텐데 그 판단이 어려워서 더 익숙한 블루-그린을 계속 선택하게 될 것 같은 느낌이랄까?

#### 주절주절

블루-그린 방식으로 배포를 하면서 가장 좋았던 점은 구버전의 POD가 유지되기 때문에 이슈가 생겼을 때 빠른 롤백이 가능하다는 것이다. 물론 배포할 때 자원이 2배로 필요할테니까 롤백할 일이 많지 않고 이슈가 발생해도 상대적으로 크리티컬하지 않은 모듈(~~우리 모듈~~) 같은 경우엔 적절하지 않을수도 있겠지만, 일단 배포하는 내 마음이 좀 덜 떨렸고 … 편했고 … 편했고 …

devops 파트에서 공유해준 자료를 참고하자면, 롤링 배포를 하면 (1) 추가적인 POD 생성이 필요하지 않아 비용 절감 효과가 있고 (2) POD 마다 차례로 배포를 진행하기에 상황에 따라 손쉽게 Revision Number에 따라서 롤백이 가능함에 따라 휴먼 에러를 감소할 수 있다고 한다. 구버전의 POD를 롤백할 때 순차적인 POD 교체로 인해서 롤백시간이 POD의 수에 따라서 달라진다는 단점도 있다고 하는데, 이슈가 최대한 빨리 해결되어야 하는 주문이나 상품 모듈 쪽에서 선택하기엔 부담스러울 것 같다는 생각이 든다.

#### +) 롤링 배포 방식을 선택하면 블루-그린 배포와 절차가 달라질텐데 배포 운영 프로세스는 기존과 동일하게 유지하게 되는건가?

회사에서 Jira Workflow를 통해서 배포를 하게 되는데, 배포 방식을 선택할 수 있으면 개발자가 현재 하는 배포 운영 프로세스도 달라지게 되는지 궁금했다.

> 👨🏽‍💻 : Rolling 배포 방식을 선택하면 기존의 블루-그린 배포와 절차가 다르다. 블루-그린 방식과 달리 롤링 배포 방식에서는 구POD 삭제가 필요없다. 따라서 기존 Jira Workflow에 따라서 배포 완료 후 구POD상태로 변경 시 파이프라인이 동작하지 않게 된다. 즉, Jira Workflow의 절차가 달라지진 않고 파이프라인상에서 동작하지 않게 된다.
